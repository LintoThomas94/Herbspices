<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root {
      --primary-color: #6a11cb;
      --secondary-color: #2575fc;
      --card-bg: #ffffff;
      --body-bg: #f5f7fa;
      --text-dark: #333;
      --text-light: #666;
      --border-light: #e0e6ed;
      --shadow-subtle: rgba(0, 0, 0, 0.05);
    }

    body {
      background: var(--body-bg);
      font-family: 'Inter', sans-serif;
      color: var(--text-dark);
    }

    /* Fixed Header Styles */
    .header {
      position: fixed; /* Make the header stick to the top */
      top: 0;
      left: 0;
      width: calc(100% - 220px); /* Adjust for the fixed sidebar */
      height: 90px; /* Give the header a fixed height */
      background: white;
      z-index: 1000; /* Ensure the header is always on top */
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-left: 260px;
    }

    .page-title { font-size: 26px; font-weight: bold; color: #2c3e50; }

    /* Adjust main content padding to prevent it from being hidden behind the fixed header */
    .main-content { padding: 88px 8px 8px 8px; margin-left: 220px; }

    .search-container {
      display: flex; align-items: center; background: #f5f7fa;
      border-radius: 30px; padding: 5px 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .search-input { border: none; outline: none; padding: 8px 12px; font-size: 14px; flex: 1; background: transparent; }
    .search-btn { border: none; background: #3498db; border-radius: 50%; padding: 8px; cursor: pointer; }
    .search-btn svg { fill: #ffffff; }

    .card {
      border: none;
      border-radius: 1rem;
      box-shadow: 0 8px 20px var(--shadow-subtle);
    }

    .form-label { font-weight: 600; color: var(--text-light); font-size: 0.875rem; }
    .form-control {
      border-radius: 0.5rem;
      border: 1px solid var(--border-light);
      padding: 0.75rem 1rem;
    }
    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.1);
    }

    .btn-gradient {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border: none; color: white !important; font-weight: 600;
      border-radius: 0.75rem; padding: 0.6rem 1.2rem;
      transition: 0.3s ease;
    }
    .btn-gradient:hover { opacity: 0.9; transform: translateY(-1px); }

    .table th {
      background-color: var(--body-bg);
      color: var(--text-light);
      font-weight: 600; font-size: 0.8rem;
      text-transform: uppercase;
    }
    .table td { background-color: var(--card-bg); vertical-align: middle; }

    .badge { font-size: 0.75rem; padding: 0.4em 0.8em; border-radius: 20px; }

    /* Pagination */
    .custom-pagination .page-link {
      border-radius: 50px !important; margin: 0 4px;
      padding: 8px 15px; border: none; color: var(--secondary-color);
      font-weight: 600; background: var(--card-bg);
      box-shadow: 0 3px 6px var(--shadow-subtle);
      transition: 0.3s ease-in-out;
    }
    .custom-pagination .active .page-link {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: #fff;
    }
  </style>
</head>

<body>
  <%- include("../../views/partials/admin/header") %>

  <header class="header">
    <h1 class="page-title">Category</h1>
    <div class="search-container">
      <input type="text" class="search-input" placeholder="Search ...">
      <button class="search-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 
                   16 11.11 16 9.5 16 5.91 13.09 3 
                   9.5 3S3 5.91 3 9.5 5.91 16 9.5 
                   16c1.61 0 3.09-.59 4.23-1.57l.27.28
                   v.79l5 4.99L20.49 19l-4.99-5z" />
        </svg>
      </button>
    </div>
  </header>
  
  <main class="main-content">
    <div class="row mb-4">
      <div class="col-12">
        <div class="card p-4">
          <h5 class="mb-4" style="color: var(--primary-color);">
            <i class="bi bi-plus-circle"></i> Add New Category
          </h5>
          <form method="post" action="/admin/addCategory" onsubmit="return handleFormSubmit(event)">
            <div class="mb-3">
              <label class="form-label">Name</label>
              <input type="text" name="name" class="form-control" placeholder="Enter category name" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Description</label>
              <textarea name="description" class="form-control" placeholder="Enter description" rows="3" required></textarea>
            </div>
            <button class="btn btn-gradient w-100">Create Category</button>
          </form>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="card p-3">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="m-0" style="color: var(--primary-color);">
              <i class="bi bi-list-ul"></i> Category List
            </h5>
          </div>

          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Description</th>
                  <th>Offer Price</th>
                  <th>Offer</th>
                  <th>Status</th>
                  <th>Actions</th>
                  <th>Edit</th>
                  <th>Delete</th>
                </tr>
              </thead>
              <tbody>
                <% cat.forEach((category, index) => { %>
                  <tr>
                    <td><%= index + 1 %></td>
                    <td><b><%= category.name %></b></td>
                    <td class="text-truncate" style="max-width: 250px;"><%= category.description %></td>
                    <td><%= category.categoryOffer ? category.categoryOffer + '%' : '0' %></td>
                    <td>
                      <% if (category.categoryOffer === 0) { %>
                        <button class="btn btn-sm btn-gradient" onclick="addOffer('<%= category._id %>')">Add Offer</button>
                      <% } else { %>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeOffer('<%= category._id %>')">Remove</button>
                      <% } %>
                    </td>
                    <td>
                      <% if(category.isListed) { %>
                        <span class="badge bg-success">Listed</span>
                      <% } else { %>
                        <span class="badge bg-danger">Unlisted</span>
                      <% } %>
                    </td>
                    <td>
                      <% if(category.isListed) { %>
                        <a href="/admin/unlistCategory?id=<%=category._id%>" class="btn btn-danger btn-sm">Unlist</a>
                      <% } else { %>
                        <a href="/admin/listCategory?id=<%=category._id%>" class="btn btn-success btn-sm">List</a>
                      <% } %>
                    </td>
                    <td>
                      <a href="/admin/editCategory/<%= category._id %>" class="btn btn-info btn-sm">Edit</a>
                    </td>
                    <td>
                      <button class="btn btn-sm btn-danger" onclick="deleteCategory('<%= category._id %>')">Delete</button>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>

          <div class="mt-4">
            <nav aria-label="Page navigation">
              <ul class="pagination justify-content-center custom-pagination">
                <% for (let i = 1; i <= totalPages; i++) { %>
                  <li class="page-item <%= (i === currentPage) ? 'active' : '' %>">
                    <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                  </li>
                <% } %>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </main>
</body>

<script>

</script>